#!/usr/bin/perl -w
# github.com/g4br13I/perlscanner

use IO::Socket;
$h = $ARGV[0];

print <<EOF;
       ,-.                    .\'\\ _
      ,\'   \\                 .\'   (_)
     J     \'-._ /\\         .\'     (,_)
    /  _  /   ,\'\# )_       _\\_     (_)
   /  \'_Y\'   /_.,\'  \\     (  _\')     \\
   | _ /   ,\'\\/  .   |    \'.  __)     \\
   |\'.Y   / \# ) --\'  /  _.-\'  __)    .\'
_._\\,\'  ,\'__,\'      /  _\\    / \\   .\'
  ,\'-_ /           _.-\' _\\  /   \\.\'
 \'    (_       _.-\' _.-\'  \\/        \@g4br13I
        \\  _.-\' _.-\' \'-.     ./
         -\'  .-\'        \'-.-\'/
         |   \\o     _.-\'\#\#\#\#/
         |    \\o_.-\' \\\#\#\#\#\#/
         |_.-\#\\       \\\#\#\#/
         \#\#\#\#\#\#\\       \\/\'
         \# \#\#\#\#\#`-.

EOF

if($#ARGV+1 != 1) { die "\033[91m[-]\033[0m perl $0 <host>\n"; }
@portas = (21,22,23,25,53,110,145,80,443,135,137,139,445,1433,3306,3389,5900);
foreach $p (@portas) {
        $c = IO::Socket::INET->new(PeerAddr => $h, PeerPort => $p, Proto => "tcp", Timeout => 1);
        if($c){
                print "\033[92m[+]\033[0m port ",$p," open\n";
        } else {
                print "\033[91m[-]\033[0m port ",$p," closed\n";
        }
}
